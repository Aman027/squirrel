{% extends 'tracker/base.html'%}
{% load bootstrap3 %}


{% block body %}
<div class=" dashboard">
        {% if context_type == 'dashboard'%}
            <section>
                <div class="row">
                    <div class="col-md-4 no-padding">
                         <div class="dashboard-card total-records">
                            <div class="header">{{total_records}}</div>
                            <div class="content">
                                <div class="sub-header">Total Records</div>
                                <div class="this-month col-md-6">This month: </div>
                                <div class="col-md-6">{{totalRecordsInThisMonth}}</div>
                                <div class="last-month col-md-6">Last month:</div>
                                <div class="col-md-6">{{totalRecordsInLastMonth}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 no-padding">
                        <div class="dashboard-card total-expenses">
                            <div class="header">${{total_expenses}}</div>
                            <div class="content">
                                <div class="sub-header">Total Expenses</div>
                                <div class="this-month col-md-6">This month: </div>
                                <div class="col-md-6">${{totalExpensesInThisMonth}}</div>
                                <div class="last-month col-md-6">Last month:</div>
                                <div class="col-md-6">${{totalExpensesInLastMonth}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 no-padding">
                        <div class="dashboard-card categories">
                            <div class="header">{{categories_cnt}}</div>
                                <div class="sub-header">Categories</div>
                                <div class="this-month col-md-6">This month: </div>
                                <div class="col-md-6">{{categories_in_this_month}}</div>
                                <div class="last-month col-md-6">Last month:</div>
                                <div class="col-md-6">{{categories_in_last_month}}</div>
                            </div>
                        </div>
                    <div class="col-md-4 no-padding">
                        <div class="dashboard-card avg-year">
                            <div class="header">${{avg_year}}</div>
                            <div class="content">Avg. year</div>
                        </div>
                    </div>
                    <div class="col-md-4 no-padding">
                        <div class="dashboard-card avg-month">
                            <div class="header">${{avg_month}}</div>
                            <div class="content">Avg. month</div>
                        </div>
                    </div>
                    <div class="col-md-4 no-padding">
                        <div class="dashboard-card avg-day">
                            <div class="header">${{avg_day}}</div>
                            <div class="content">Avg. day</div>
                        </div>
                    </div>
                </div>
            </section>

            {% if categories %}
                <section>
                    <div class="row">
                        <div class="col-md-6 no-padding">
                            <canvas id="allCategories" class="allCategories" ></canvas>
                            <script>
                                var ctx = document.getElementById("allCategories").getContext('2d');
                                var allCategories = new Chart(ctx, {
                                    type: 'pie',
                                    data: {
                                        "labels": {{ categories | safe }},
                                            "datasets":[
                                             {
                                                "data": {{ categories_record_cnt | safe }},
                                                  backgroundColor: {{categories_color_arr| safe }}
                                             }
                                      ]
                                    },

                                    options: {
                                        legend: {
                                             labels: {
                                                  fontColor: "#e5ffff"
                                                 }
                                              },
                                            title: {
                                                display: true,
                                                fontColor: "#e5ffff",
                                                text: 'Categories'
                                            }
                                    }
                                });
                            </script>
                        </div>
                        <div class="col-md-6 no-padding">
                            <canvas id="allCategoriesRadar" class="allCategoriesRadar"></canvas>
                            <script>
                                var ctx = document.getElementById("allCategoriesRadar").getContext('2d');
                                var allCategories = new Chart(ctx, {
                                    type: 'horizontalBar',
                                    data: {
                                        "labels": {{ categories | safe }},
                                         "datasets":[
                                             {
                                                "data": {{ categories_expense | safe }},
                                                "fill": true,
                                                 "backgroundColor": "#fff",
                                                "borderColor": "#fff;",
                                             }
                                      ]
                                    },
                                    options: {
                                    legend: {
                                        display: false
                                    },
                                    responsive: true,
                                    title: {
                                        display: true,
                                        text: 'Expenses per Categories'
                                    },
                                    tooltips: {
                                        mode: 'index',
                                        intersect: false,
                                    },
                                    hover: {
                                        mode: 'nearest',
                                        intersect: true
                                    }
                                    ,
                                    scales: {
                                        xAxes: [{
                                            display: true,
                                            scaleLabel: {
                                                display: true,
                                                labelString: "Amount"
                                            }
                                        }],
                                        yAxes: [{
                                        stacked: true,
                                            display: true,
                                            scaleLabel: {
                                                display: true,
                                                labelString: 'Categories'
                                            }
                                        }]
                                    }
                                }
                                });
                            </script>
                        </div>
                    </div>
                </section>
            {% endif %}




            {% if latest30DaysData %}
                <section>
                    <div class="row">
                        <div class="col-md-12">
                            <canvas id="latest30DaysExpense" class="latest30DaysExpense" width="500" height="100"></canvas>
                            <script>
                                var ctx = document.getElementById("latest30DaysExpense").getContext('2d');
                                var latest30daysRecords = new Chart(ctx, {
                                    type: 'line',
                                    data: {
                                        "labels": {{ latest30DaysLabel | safe }},
                                      "datasets":[
                                         {
                                            "label":"Amount",
                                            "data": {{ latest30DaysData | safe }},
                                            "fill":false,
                                            "borderColor":"#e5ffff",
                                            "lineTension":0.1
                                         }
                                      ]
                                    },
                                    options: {
                                        legend: {
                                             labels: {
                                                  fontColor: "#e5ffff"
                                                 }
                                              },
                                            title: {
                                                display: true,
                                                fontColor: "#e5ffff",
                                                text: 'Expenses in Last 30 Days'
                                            }     ,
                                            scales: {
                                                yAxes: [{
                                                    ticks: {
                                                        beginAtZero:true,
                                                        fontColor: "#e5ffff"
                                                    },
                                                }],
                                              xAxes: [{
                                                    ticks: {
                                                        fontColor: "#e5ffff"
                                                    },
                                                }]
                                        }

                                    }
                                });
                            </script>
                        </div>
                    </div>
                </section>
            {% endif %}

            <section>
                <div class="row">
                <div class="col-md-4 no-padding">
                    <a href="{% url 'tracker:analytics'%}/{{current_year}}">
                        <div class="dashboard-card annually-report">
                            <div class="header">annually Report</div>
                        </div>
                    </a>
                </div>
                <div class="col-md-4 no-padding">
                    <a href="{% url 'tracker:analytics'%}/{{current_year}}/{{current_month}}">
                        <div class="dashboard-card monthly-report">
                            <div class="header">Monthly Report</div>
                        </div>
                    </a>
                </div>
                <div class="col-md-4 no-padding">
                    <a href="{% url 'tracker:analytics'%}/{{current_year}}/{{current_month}}/{{current_day}}">
                        <div class="dashboard-card daily-report">
                            <div class="header">Daily Report</div>
                        </div>
                    </a>
                </div>
            </div>
            </section>

        {% endif %}
</div>

{% endblock %}
</div>